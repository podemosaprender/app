Hola Mundo!

<!-- SEE: https://developer.github.com/apps/building-oauth-apps/authorizing-oauth-apps/#web-application-flow -->

<p><a href="https://github.com/login/oauth/authorize?client_id=b1435b2c5017a7244412&scope=user%20public_repo">Entrar con github</a></p>

<script>
  APP_URL="https://www.podemosaprender.org/app/"; //U: la api la pide, tiene que ser igual a redirect url
  APP_CLIENT_ID="b1435b2c5017a7244412";
  APP_SECRET="917d6bffd830dafb90365f14c1aa3b0a5204df73";
  AUTH_TOKEN= null;

  function set_api_file(repo,fname,data) {
    //SEE: https://developer.github.com/v3/repos/contents/#create-a-file
    url= "/repos/"+USER.login+"/"+repo+"/contents/"+fname;
    xp= fetch(url, {
       headers: {
          "Authorization": "token "+AUTH_TOKEN,
          "Content-type": "application/json"
       },
       method: "PUT",
       mode: "cors",
       cache: "no-cache",
       body: JSON.stringify(data)
    });
    xp.then(response => response.json())
      .then( d => { console.log("FILE",d); USER=d });       
  }

  function api_user() {
    url= "https://api.github.com/user"
    xp= fetch(url, {
        headers: {
          "Authorization": "token "+AUTH_TOKEN,
        },
        mode: "cors", // no-cors, cors, *same-origin
        cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
        credentials: "same-origin", // include, *same-origin, omit
        redirect: "follow", // manual, *follow, error
        referrer: "no-referrer", // no-referrer, *client
    })
    
    xp.then(response => response.json())
      .then( d => { console.log("USER",d); USER=d });  
  }

  function api_token(code) {
    //SEE: https://developer.mozilla.org/en-US/docs/Web/API/Fetch_API/Using_Fetch
    url= "https://cors-anywhere.herokuapp.com/https://github.com/login/oauth/access_token?client_id="+APP_CLIENT_ID+
            "&client_secret="+APP_SECRET+
            "&redirect_uri="+APP_URL+
            "&code="+code; //XXX:SEC le estamos dando el access token a cors-anywhere!!! Usar https://github.com/prose/gatekeeper

    xp= fetch(url, {
        method: "POST", // *GET, POST, PUT, DELETE, etc.
        mode: "cors", // no-cors, cors, *same-origin
        cache: "no-cache", // *default, no-cache, reload, force-cache, only-if-cached
        credentials: "same-origin", // include, *same-origin, omit
        redirect: "follow", // manual, *follow, error
        referrer: "no-referrer", // no-referrer, *client
    })
    
    xp.then(response => response.text())
      .then( d => { console.log("AUTH TOK",d); AUTH_TOKEN= (d.match(/access_token=([^&]+)/)||[])[1] });
  }

  function api_check() {
    if (_t= window.location.href.match(/code=([^&]+)/)) { 
      window.location.href= window.location.href.replace(/\?.*/,"");
      api_token(_t[1]);
    }
  }

  api_check();

</script>

